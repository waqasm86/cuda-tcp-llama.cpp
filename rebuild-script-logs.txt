waqasm86@waqasm86-ThinkPad-T450s:/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10$ grep -n "request_size" src/transport/ucx_transport.cpp
91:  params.request_size = sizeof(void*);
waqasm86@waqasm86-ThinkPad-T450s:/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10$ grep -n "ucp_tag_send_nbx" src/transport/ucx_transport.cpp
319:  void* req = ucp_tag_send_nbx(ep_, bytes, len, tag, &param);
waqasm86@waqasm86-ThinkPad-T450s:/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10$ 
waqasm86@waqasm86-ThinkPad-T450s:/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10$ chmod +x fix_ucx_transport.sh
waqasm86@waqasm86-ThinkPad-T450s:/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10$ ./fix_ucx_transport.sh
=== UCX Transport Direct Fix ===

✓ Backup created
✓ Fixed ucx_transport.cpp created

Verifying critical fixes are present:
  ✓ request_size fix present
  ✓ nbx API fix present

=== Fix applied successfully! ===
Now rebuild with: ./rebuild_script.sh
./fix_ucx_transport.sh: line 458: EOFUCX: command not found
waqasm86@waqasm86-ThinkPad-T450s:/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10$ ./rebuild_script.sh
=== UCX-LLAMA Bridge Rebuild ===

[1] Checking UCX installation...
UCX version: 1.21.0
UCX libs: -L/usr/local/lib -lucp -luct -lucs -lucm

[2] Cleaning old build...

[3] Configuring CMake...
-- The CXX compiler identification is GNU 11.4.0
-- The CUDA compiler identification is NVIDIA 12.8.61 with host compiler GNU 11.4.0
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Detecting CUDA compiler ABI info
-- Detecting CUDA compiler ABI info - done
-- Check for working CUDA compiler: /usr/local/cuda-12.8/bin/nvcc - skipped
-- Detecting CUDA compile features
-- Detecting CUDA compile features - done
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success
-- Found Threads: TRUE
-- UCX enabled via pkg-config module: ucx
-- Found CUDAToolkit: /usr/local/cuda-12.8/targets/x86_64-linux/include (found version "12.8.61")
-- Configuring done (2.9s)
-- Generating done (0.0s)
-- Build files have been written to: /media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/build

[4] Building...
ninja: Entering directory `build'
[1/12] /usr/bin/c++ -DCC50_ENABLE_UCX=1 -I/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include -isystem /usr/local/include/stubs -g -std=gnu++20 -Wall -Wextra -Wpedantic -MD -MT CMakeFiles/cc50_transport_ucx.dir/src/transport/ucx_transport.cpp.o -MF CMakeFiles/cc50_transport_ucx.dir/src/transport/ucx_transport.cpp.o.d -o CMakeFiles/cc50_transport_ucx.dir/src/transport/ucx_transport.cpp.o -c /media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/transport/ucx_transport.cpp
[2/12] : && /usr/local/bin/cmake -E rm -f libcc50_transport_ucx.a && /usr/bin/ar qc libcc50_transport_ucx.a  CMakeFiles/cc50_transport_ucx.dir/src/transport/ucx_transport.cpp.o && /usr/bin/ranlib libcc50_transport_ucx.a && :
[3/12] /usr/bin/c++  -I/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include -g -std=gnu++20 -Wall -Wextra -Wpedantic -MD -MT CMakeFiles/cc50_backend_llama_server.dir/src/backend/llama_server_backend.cpp.o -MF CMakeFiles/cc50_backend_llama_server.dir/src/backend/llama_server_backend.cpp.o.d -o CMakeFiles/cc50_backend_llama_server.dir/src/backend/llama_server_backend.cpp.o -c /media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/llama_server_backend.cpp
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/llama_server_backend.cpp:19:20: warning: ‘std::string cc50::ltrim_copy(std::string)’ defined but not used [-Wunused-function]
   19 | static std::string ltrim_copy(std::string s) {
      |                    ^~~~~~~~~~
[4/12] : && /usr/local/bin/cmake -E rm -f libcc50_backend_llama_server.a && /usr/bin/ar qc libcc50_backend_llama_server.a  CMakeFiles/cc50_backend_llama_server.dir/src/backend/llama_server_backend.cpp.o && /usr/bin/ranlib libcc50_backend_llama_server.a && :
[5/12] /usr/bin/c++  -I/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include -g -std=gnu++20 -Wall -Wextra -Wpedantic -MD -MT CMakeFiles/cc50_llm_client.dir/src/client.cpp.o -MF CMakeFiles/cc50_llm_client.dir/src/client.cpp.o.d -o CMakeFiles/cc50_llm_client.dir/src/client.cpp.o -c /media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/client.cpp
[6/12] /usr/bin/c++  -I/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include -g -std=gnu++20 -Wall -Wextra -Wpedantic -MD -MT CMakeFiles/cc50_transport_tcp.dir/src/transport/tcp_transport.cpp.o -MF CMakeFiles/cc50_transport_tcp.dir/src/transport/tcp_transport.cpp.o.d -o CMakeFiles/cc50_transport_tcp.dir/src/transport/tcp_transport.cpp.o -c /media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/transport/tcp_transport.cpp
[7/12] : && /usr/local/bin/cmake -E rm -f libcc50_transport_tcp.a && /usr/bin/ar qc libcc50_transport_tcp.a  CMakeFiles/cc50_transport_tcp.dir/src/transport/tcp_transport.cpp.o && /usr/bin/ranlib libcc50_transport_tcp.a && :
[8/12] /usr/bin/c++  -I/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include -g -std=gnu++20 -Wall -Wextra -Wpedantic -MD -MT CMakeFiles/cc50_llm_server.dir/src/server.cpp.o -MF CMakeFiles/cc50_llm_server.dir/src/server.cpp.o.d -o CMakeFiles/cc50_llm_server.dir/src/server.cpp.o -c /media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/server.cpp
[9/12] : && /usr/bin/c++ -g  CMakeFiles/cc50_llm_client.dir/src/client.cpp.o -o cc50_llm_client  -Wl,-rpath,/usr/local/lib  libcc50_transport_tcp.a  libcc50_transport_ucx.a  /usr/local/lib/libucp.so  /usr/local/lib/libuct.so  /usr/local/lib/libucs.so  /usr/local/lib/libucm.so && :
[10/12] /usr/local/cuda-12.8/bin/nvcc -forward-unknown-to-host-compiler  -I/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include -isystem /usr/local/cuda-12.8/targets/x86_64-linux/include -g -std=c++20 "--generate-code=arch=compute_50,code=[compute_50,sm_50]" -Xcompiler=-Wall,-Wextra,-Wpedantic -MD -MT CMakeFiles/cc50_backend_toy.dir/src/backend/toy_backend.cu.o -MF CMakeFiles/cc50_backend_toy.dir/src/backend/toy_backend.cu.o.d -x cu -c /media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu -o CMakeFiles/cc50_backend_toy.dir/src/backend/toy_backend.cu.o
nvcc warning : Support for offline compilation for architectures prior to '<compute/sm/lto>_75' will be removed in a future release (Use -Wno-deprecated-gpu-targets to suppress warning).
/tmp/tmpxft_0000d6ba_00000000-6_toy_backend.cudafe1.cpp:1:3: warning: style of line directive is a GCC extension
    1 | # 1 "/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu"
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:2:3: warning: style of line directive is a GCC extension
    2 | #include <cuda_runtime.h>
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:2:3: warning: style of line directive is a GCC extension
    2 | #include <cuda_runtime.h>
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:2:3: warning: style of line directive is a GCC extension
    2 | #include <cuda_runtime.h>
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:2:3: warning: style of line directive is a GCC extension
    2 | #include <cuda_runtime.h>
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:2:3: warning: style of line directive is a GCC extension
    2 | #include <cuda_runtime.h>
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:2:3: warning: style of line directive is a GCC extension
    2 | #include <cuda_runtime.h>
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:3:3: warning: style of line directive is a GCC extension
    3 | #include <cstring>
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:7:3: warning: style of line directive is a GCC extension
    7 | static __global__ void spin_kernel(uint32_t iters, uint32_t* out) {
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:1:3: warning: style of line directive is a GCC extension
    1 | #include "cc50/backend/toy_backend.hpp"
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:11:3: warning: style of line directive is a GCC extension
   11 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:13:3: warning: style of line directive is a GCC extension
   13 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:15:3: warning: style of line directive is a GCC extension
   15 |   using namespace std::chrono;
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:16:3: warning: style of line directive is a GCC extension
   16 |   return duration_cast<microseconds>(steady_clock::now().time_since_epoch()).count();
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:17:3: warning: style of line directive is a GCC extension
   17 | }
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:18:3: warning: style of line directive is a GCC extension
   18 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:20:3: warning: style of line directive is a GCC extension
   20 |   bool ok{true};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:21:3: warning: style of line directive is a GCC extension
   21 |   std::string msg{};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:22:3: warning: style of line directive is a GCC extension
   22 |   static Status Ok() { return {true, {}}; }
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:23:3: warning: style of line directive is a GCC extension
   23 |   static Status Err(std::string m) { return {false, std::move(m)}; }
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:24:3: warning: style of line directive is a GCC extension
   24 | };
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:25:3: warning: style of line directive is a GCC extension
   25 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:27:3: warning: style of line directive is a GCC extension
   27 |   throw std::runtime_error(m);
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:28:3: warning: style of line directive is a GCC extension
   28 | }
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:29:3: warning: style of line directive is a GCC extension
   29 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/../common.hpp:31:3: warning: style of line directive is a GCC extension
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:9:3: warning: style of line directive is a GCC extension
    9 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:11:3: warning: style of line directive is a GCC extension
   11 |   uint64_t req_id{0};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:12:3: warning: style of line directive is a GCC extension
   12 |   uint32_t max_tokens{64};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:13:3: warning: style of line directive is a GCC extension
   13 |   uint32_t credit_bytes{256 * 1024};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:14:3: warning: style of line directive is a GCC extension
   14 |   std::string prompt{};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:15:3: warning: style of line directive is a GCC extension
   15 | };
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:16:3: warning: style of line directive is a GCC extension
   16 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:18:3: warning: style of line directive is a GCC extension
   18 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:20:3: warning: style of line directive is a GCC extension
   20 |   uint32_t tokens{0};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:21:3: warning: style of line directive is a GCC extension
   21 |   uint64_t elapsed_us{0};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:22:3: warning: style of line directive is a GCC extension
   22 |   std::string text{};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:23:3: warning: style of line directive is a GCC extension
   23 |   std::string error{};
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:24:3: warning: style of line directive is a GCC extension
   24 | };
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:25:3: warning: style of line directive is a GCC extension
   25 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:27:3: warning: style of line directive is a GCC extension
   27 | public:
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:29:3: warning: style of line directive is a GCC extension
   29 |   virtual Status init() = 0;
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:30:3: warning: style of line directive is a GCC extension
   30 |   virtual Status load_model(const std::string& path, int ctx, int threads) = 0;
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:31:3: warning: style of line directive is a GCC extension
   31 |   virtual Status infer_stream(const InferRequest& req, StreamFn on_chunk, InferResult& out) = 0;
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:32:3: warning: style of line directive is a GCC extension
   32 | };
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:33:3: warning: style of line directive is a GCC extension
   33 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/backend.hpp:35:3: warning: style of line directive is a GCC extension
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/toy_backend.hpp:5:3: warning: style of line directive is a GCC extension
    5 | 
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/toy_backend.hpp:9:3: warning: style of line directive is a GCC extension
    9 | public:
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/toy_backend.hpp:11:3: warning: style of line directive is a GCC extension
   11 |   Status load_model(const std::string& path, int ctx, int threads) override;
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/toy_backend.hpp:12:3: warning: style of line directive is a GCC extension
   12 |   Status infer_stream(const InferRequest& req, StreamFn on_chunk, InferResult& out) override;
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/toy_backend.hpp:13:3: warning: style of line directive is a GCC extension
   13 | };
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/toy_backend.hpp:14:3: warning: style of line directive is a GCC extension
   14 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/include/cc50/backend/toy_backend.hpp:16:3: warning: style of line directive is a GCC extension
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:6:3: warning: style of line directive is a GCC extension
    6 | 
      |   ^
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:24:3: warning: style of line directive is a GCC extension
   24 | }
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:16:3: warning: style of line directive is a GCC extension
   16 |   int dev = 0;
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:17:3: warning: style of line directive is a GCC extension
   17 |   cudaError_t e = cudaSetDevice(dev);
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:18:3: warning: style of line directive is a GCC extension
   18 |   if (e != cudaSuccess) return Status::Err(std::string("cudaSetDevice failed: ") + cudaGetErrorString(e));
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:19:3: warning: style of line directive is a GCC extension
   19 |   return Status::Ok();
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:20:3: warning: style of line directive is a GCC extension
   20 | }
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:21:3: warning: style of line directive is a GCC extension
   21 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:23:3: warning: style of line directive is a GCC extension
   23 |   return Status::Ok();
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:24:3: warning: style of line directive is a GCC extension
   24 | }
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:25:3: warning: style of line directive is a GCC extension
   25 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:27:3: warning: style of line directive is a GCC extension
   27 |   const uint64_t t0 = now_us();
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:28:3: warning: style of line directive is a GCC extension
   28 |   out.tokens = 0;
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:29:3: warning: style of line directive is a GCC extension
   29 |   out.elapsed_us = 0;
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:30:3: warning: style of line directive is a GCC extension
   30 |   out.text.clear();
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:31:3: warning: style of line directive is a GCC extension
   31 |   out.error.clear();
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:32:3: warning: style of line directive is a GCC extension
   32 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:35:3: warning: style of line directive is a GCC extension
   35 |   cudaMalloc(&d_out, sizeof(uint32_t));
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:36:3: warning: style of line directive is a GCC extension
   36 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:39:3: warning: style of line directive is a GCC extension
   39 |   for (uint32_t i = 0; i < req.max_tokens; i++) {
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:40:3: warning: style of line directive is a GCC extension
   40 |     spin_kernel<<<8, 256>>>(iters, d_out);
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:41:3: warning: style of line directive is a GCC extension
   41 |     cudaDeviceSynchronize();
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:42:3: warning: style of line directive is a GCC extension
   42 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:45:3: warning: style of line directive is a GCC extension
   45 |     out.text += " token";
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:46:3: warning: style of line directive is a GCC extension
   46 |     out.tokens++;
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:47:3: warning: style of line directive is a GCC extension
   47 |   }
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:48:3: warning: style of line directive is a GCC extension
   48 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:50:3: warning: style of line directive is a GCC extension
   50 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:52:3: warning: style of line directive is a GCC extension
   52 |   return Status::Ok();
      |   ^~
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:53:3: warning: style of line directive is a GCC extension
   53 | }
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:54:3: warning: style of line directive is a GCC extension
   54 | 
      |   ^ 
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:57:3: warning: style of line directive is a GCC extension
tmpxft_0000d6ba_00000000-6_toy_backend.cudafe1.stub.c:4:3: warning: style of line directive is a GCC extension
In file included from tmpxft_0000d6ba_00000000-6_toy_backend.cudafe1.stub.c:1:
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:8:3: warning: style of line directive is a GCC extension
    8 |   uint32_t x = threadIdx.x + blockIdx.x * blockDim.x;
      |   ^
In file included from tmpxft_0000d6ba_00000000-6_toy_backend.cudafe1.stub.c:1:
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:8:3: warning: style of line directive is a GCC extension
    8 |   uint32_t x = threadIdx.x + blockIdx.x * blockDim.x;
      |   ^~
In file included from tmpxft_0000d6ba_00000000-6_toy_backend.cudafe1.stub.c:1:
/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10/src/backend/toy_backend.cu:14:3: warning: style of line directive is a GCC extension
   14 | 
      |   ^
tmpxft_0000d6ba_00000000-6_toy_backend.cudafe1.stub.c:2:3: warning: style of line directive is a GCC extension
[11/12] : && /usr/local/bin/cmake -E rm -f libcc50_backend_toy.a && /usr/bin/ar qc libcc50_backend_toy.a  CMakeFiles/cc50_backend_toy.dir/src/backend/toy_backend.cu.o && /usr/bin/ranlib libcc50_backend_toy.a && :
[12/12] : && /usr/bin/c++ -g  CMakeFiles/cc50_llm_server.dir/src/server.cpp.o -o cc50_llm_server -L/usr/local/cuda-12.8/targets/x86_64-linux/lib/stubs   -L/usr/local/cuda-12.8/targets/x86_64-linux/lib -Wl,-rpath,/usr/local/lib:/usr/local/cuda-12.8/targets/x86_64-linux/lib  libcc50_transport_tcp.a  libcc50_transport_ucx.a  libcc50_backend_toy.a  libcc50_backend_llama_server.a  /usr/local/lib/libucp.so  /usr/local/lib/libuct.so  /usr/local/lib/libucs.so  /usr/local/lib/libucm.so  /usr/local/cuda-12.8/targets/x86_64-linux/lib/libcudart.so  -ldl  /usr/lib/x86_64-linux-gnu/librt.a  -lcudadevrt  -lcudart_static  -lrt  -lpthread  -ldl && :

[5] Build successful!

[6] Setting environment variables...
Environment:
  LD_LIBRARY_PATH=/usr/local/lib:/usr/local/lib:/usr/local/lib:/usr/local/lib:/opt/ucx-cuda/lib:/usr/local/cuda-12.8/lib64
  UCX_TLS=tcp,self
  UCX_NET_DEVICES=lo
  UCX_LOG_LEVEL=info

[7] Testing server startup...
Command: ./build/cc50_llm_server --transport=ucx --backend=llama_server --listen=127.0.0.1:9199 --llama-url=http://127.0.0.1:8090 --llama-endpoint=/completion

[UCX] Transport constructor called
[UCX] Starting server...
[UCX] Initializing UCX common...
[UCX] sizeof(ucp_params_t) = 88
[UCX] About to call ucp_config_read...
malloc(): corrupted top size
timeout: the monitored command dumped core
./rebuild_script.sh: line 101: 55037 Aborted                 timeout 3s ./build/cc50_llm_server --transport=ucx --backend=llama_server --listen=127.0.0.1:9199 --llama-url=http://127.0.0.1:8090 --llama-endpoint=/completion
Server crashed with exit code 134
waqasm86@waqasm86-ThinkPad-T450s:/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10$ ldd ./build/cc50_llm_server | grep ucp
	libucp.so.0 => /usr/local/lib/libucp.so.0 (0x00007d90352aa000)
waqasm86@waqasm86-ThinkPad-T450s:/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10$ ldconfig -p | grep ucp
	libucp.so.0 (libc6,x86-64) => /usr/local/lib/libucp.so.0
	libucp.so.0 (libc6,x86-64) => /lib/libucp.so.0
	libucp.so (libc6,x86-64) => /usr/local/lib/libucp.so
	libucp.so (libc6,x86-64) => /lib/libucp.so
waqasm86@waqasm86-ThinkPad-T450s:/media/waqasm86/External1/Project-CPP/Project-Nvidia/ucx-llama-infer-accel-10$ ./build/cc50_llm_server \
  --transport=tcp \
  --backend=llama_server \
  --listen=127.0.0.1:9199 \
  --llama-url=http://127.0.0.1:8090 \
  --llama-endpoint=/completion
[server] transport=tcp backend=llama_server listen=127.0.0.1:9199
[server] llama_url=http://127.0.0.1:8090 endpoint=/completion


